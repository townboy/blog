---
layout: post
title: zoj 3231 Apple Transportation
date: 2013-04-30 21:31
categories: acmicpc
---

这道题目第一看看到就感觉是费用流，当然咯，也可以用树形dp在做。

这道题建图的时候刚开始是建成这个样子的。

<p><img src="static/images/20130430211947907.jpg" width="600" alt="Map of Angkor" /></p>

图中apple[i] 代表的就是每个节点最开始的苹果，ave指的就是平均苹果数，那么如果7个苹果，3个节点，那么ave就是2.就代表每个节点最多可以放置ave+1个苹果。

这样建图看着很正确吧，跑样例的时候发现一个问题，如果7个苹果，3个节点，那么就可能放成 1 3 3。我们少考虑了一个条件，那么就是每个节点最少放置ave个苹果。

咦，这不是上下界费用流吗，我们就试着建建图吧， 那么我们要注意的问题就是每个节点必须放置至少ave个苹果，那么就把ave个苹果拿出来考虑。以下是建图。

<p><img src="static/images/20130430213135128.jpg" width="600" alt="Map of Angkor" /></p>

sum 代表的是总的苹果树，那么sum-ave*n指的就是除去每个点平均分下去的苹果剩下的苹果树。在这其中，所以这样跑一遍网络流之后，所有点分配的苹果树肯定是符合规则的。然后我们只要设计好费用，以及在苹果树之间加上转移的边，那么就可以跑出来了。

这样的建图就可以把下届拿出来单独考虑并且满足所有的条件，可以参考周源的那篇简易方法求解上下界网络流里面的建图，其实本质是一样的，就是单独将下界提出并满足。